---
title: "Xue_combined"
author: "Xue Yang"
date: "4/5/2019"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(tidyverse)
library(haven)
```

# Diet Behavior and Nutrition

```{r}
lookup.xport("data/diet.xpt")

diet_behavior =
  read_xpt("data/diet.xpt") %>% 
  select(seqn = SEQN, 
         fast = DBD900, 
         ready = DBD905, 
         forzen = DBD910) %>% 
  filter(!fast %in% c(5555, 7777, 9999),
         !ready %in% c(6666, 7777, 9999),
         !forzen %in% c(6666, 7777, 9999))


# proportion of missing value
sum(is.na(diet_behavior$fast))/length(diet_behavior$seqn)
sum(is.na(diet_behavior$ready))/length(diet_behavior$seqn)
sum(is.na(diet_behavior$forzen))/length(diet_behavior$seqn)
```

```{r}
lookup.xport("data/diet_2014.xpt")

diet_behavior_2014 =
  read_xpt("data/diet_2014.xpt") %>% 
  select(seqn = SEQN, 
         fast = DBD900, 
         ready = DBD905, 
         forzen = DBD910) %>% 
  filter(!fast %in% c(5555, 7777, 9999),
         !ready %in% c(6666, 7777, 9999),
         !forzen %in% c(6666, 7777, 9999))


diet_behavior_all = rbind(diet_behavior_2014, diet_behavior)
```


# Body Measure

```{r}
body_measures = 
  read_xpt("data/body_measures.xpt") %>% 
  select(seqn = SEQN, 
         bmi = BMXBMI)

# proportion of missing value
sum(is.na(body_measures$bmi))/length(body_measures$seqn)
```

```{r}
body_measures_2014 = 
  read_xpt("data/body_measures_2014.xpt") %>% 
  select(seqn = SEQN, 
         bmi = BMXBMI)

body_measures_all = rbind(body_measures_2014, body_measures)
```

# Diabetes

```{r}
lookup.xport("data/diabetes.xpt")

diabetes =
  read_xpt("data/diabetes.xpt") %>% 
  select(seqn = SEQN, 
         diabete = DIQ010) %>% 
  mutate(diabete = ifelse(!(diabete %in% c(1,2,3)), NA, diabete))

# proportion of missing value
sum(is.na(diabetes$diabete))/length(diabetes$seqn)
```

```{r}
diabetes_2014 =
  read_xpt("data/diabetes_2014.xpt") %>% 
  select(seqn = SEQN, 
         diabete = DIQ010) %>% 
  mutate(diabete = ifelse(!(diabete %in% c(1,2,3)), NA, diabete))

diabetes_all = rbind(diabetes_2014, diabetes)
```

# Medical Conditions

```{r}
lookup.xport("data/medical_cond.xpt")

medical_cond =
  read_xpt("data/medical_cond.xpt") %>% 
  select(seqn = SEQN, 
         overweight = MCQ080, 
         gout = MCQ160N) %>% 
  mutate(overweight = ifelse(!(overweight %in% c(1,2)), NA, overweight),
         gout = ifelse(!(gout %in% c(1,2)), NA, gout))


# proportion of missing value
sum(is.na(medical_cond$overweight))/length(medical_cond$seqn)
sum(is.na(medical_cond$gout))/length(medical_cond$seqn)
```

```{r}
medical_cond_2014 =
  read_xpt("data/medical_cond_2014.xpt") %>% 
  select(seqn = SEQN, 
         overweight = MCQ080, 
         gout = MCQ160N) %>% 
  mutate(overweight = ifelse(!(overweight %in% c(1,2)), NA, overweight),
         gout = ifelse(!(gout %in% c(1,2)), NA, gout))

medical_cond_all = rbind(medical_cond_2014, medical_cond)
```

# Response

```{r}
coronary = 
  read_xpt("data/medical_cond.xpt") %>% 
  select(seqn = SEQN, 
         disease = MCQ160C) %>% 
  mutate(disease = ifelse(!(disease %in% c(1,2)), NA, disease))

# proportion of missing value
sum(is.na(coronary$disease))/length(coronary$seqn)
```

```{r}
coronary_2014 = 
  read_xpt("data/medical_cond_2014.xpt") %>% 
  select(seqn = SEQN, 
         disease = MCQ160C) %>% 
  mutate(disease = ifelse(!(disease %in% c(1,2)), NA, disease))

coronary_all = rbind(coronary_2014, coronary)
```

