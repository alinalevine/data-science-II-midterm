---
title: "Jiyue_part"
author: "JiyueQin"
date: "April 5, 2019"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(tidyverse)
library(haven)

```


Here, we will import the separate datasets from year 15 and 14 and combine for further analysis.

Our targets are participants who are 20 years older.


# Demographics variables


Age in years at screening: variable name RIDAGEYR
Gender: variable name RIAGENDR
Marital status: variable name DMDMARTL
Race/ethinicity: Race/Hispanic origin w/ NH Asian, variable name RIDRETH3
Citizenship status: variable name DMDCITZN
Education level: Education level - Adults 20+, variable name DMDEDUC2


sequence number, hispanic ethnicity, age,Ttotal household income

https://wwwn.cdc.gov/nchs/nhanes/search/variablelist.aspx?Component=Demographics&CycleBeginYear=2015


```{r demo}
demographics_2015 = read_xpt("data/demographics.XPT") %>% 
  janitor::clean_names() %>%
  select(seqn, ridageyr, riagendr, dmdmartl, ridreth3, dmdcitzn, dmdeduc2) %>% 
  filter(ridageyr > 20)
demographics_2014 = read_xpt("data/demographics_2014.XPT") %>% 
  janitor::clean_names() %>%
  select(seqn, ridageyr, riagendr, dmdmartl, ridreth3, dmdcitzn, dmdeduc2) %>% 
  filter(ridageyr > 20)
demographics = bind_rows(demographics_2014, demographics_2015)
demographics %>% group_by(seqn) %>% summarise(n())

```

# Income

Family monthly poverty level category, variable name: INDFMMPCSAS
https://wwwn.cdc.gov/Nchs/Nhanes/2015-2016/INQ_I.htm#INDFMMPI 

demographics = read_xpt("data/demographics.XPT") %>% janitor::clean_names()
1	Monthly poverty level index <= 1.30;2	1.30 < Monthly poverty level index <= 1.85;3	Monthly poverty level index > 1.85

```{r income}
income_2015 = read_xpt("data/income.XPT") %>% 
  janitor::clean_names() %>% 
  select(seqn, income = indfmmpc) %>% 
  mutate(income = ifelse(income %in% c(1,2,3), income, NA))

income_2014 = read_xpt("data/income_2014.XPT") %>% 
  janitor::clean_names() %>% 
  select(seqn, income = indfmmpc) %>% 
  mutate(income = ifelse(income %in% c(1,2,3), income, NA))

income = bind_rows(income_2014, income_2015)
```

#  Depression score
sum of scores for 9 items. Each item is scored as 0 (not at all) to 3 (nearly every day), which assesses the frequency of depression related symptoms.
extracted from dataset Mental Health - Depression Screener  

```{r depression}

depression_2015 = read_xpt("data/mental_health.XPT") %>% 
  janitor::clean_names()

seqn = depression_2015$seqn
depression_subset = depression_2015 %>% select(-seqn)
depression_2015 = map_dfc(depression_subset, ~ifelse(.x %in% c(0,1,2,3), .x, NA)) %>% 
  mutate(depression_score = round(rowMeans(., na.rm = TRUE), 3)) %>% 
  add_column(seqn) %>% 
  select(seqn, depression_score)

depression_2014 = read_xpt("data/mental_health_2014.XPT") %>% 
  janitor::clean_names()
seqn = depression_2014$seqn
depression_subset = depression_2014 %>% select(-seqn)
depression_2014 = map_dfc(depression_subset, ~ifelse(.x %in% c(0,1,2,3), .x, NA)) %>% 
  mutate(depression_score = round(rowMeans(., na.rm = TRUE), 3)) %>% 
  add_column(seqn) %>% 
  select(seqn, depression_score)

depression = bind_rows(depression_2014, depression_2015)
```
